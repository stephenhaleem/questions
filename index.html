<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
  />
  <title>Multi-Step Questionnaire</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: fixed;
    }

    body {
      min-height: 100svh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Inter", sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #020617 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #e5e7eb;
      padding: 16px;
      position: relative;
    }

    body::before {
      content: "";
      position: absolute;
      width: 200%;
      height: 200%;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: radial-gradient(
        circle at center,
        rgba(56, 189, 248, 0.1),
        transparent 55%
      );
      animation: pulse 8s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes pulse {
      0%,100% { opacity: .3; }
      50% { opacity: .55; }
    }

    .app {
      width: 100%;
      max-width: 500px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      z-index: 1;
    }

    .progress {
      width: 100%;
      height: 8px;
      background: rgba(255,255,255,.08);
      border-radius: 999px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg,#38bdf8,#0ea5e9,#06b6d4);
      background-size: 200% 100%;
      transition: width .5s cubic-bezier(0.4, 0, 0.2, 1);
      animation: shimmer 2s infinite;
      box-shadow: 0 0 20px rgba(56, 189, 248, 0.5);
    }

    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    #question {
      width: 100%;
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 28px 24px;
      border-radius: 18px;
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      line-height: 1.5;
      box-shadow: 
        0 20px 60px rgba(0,0,0,.4),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      transition: all .4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* SLIDE ANIMATIONS */
    .slide-out {
      opacity: 0;
      transform: translateX(-30px) scale(0.98);
    }

    .slide-in {
      opacity: 1;
      transform: translateX(0) scale(1);
    }

    input {
      width: 100%;
      padding: 15px 18px;
      font-size: 16px;
      border-radius: 14px;
      border: 2px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.08);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: #fff;
      outline: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      font-family: inherit;
    }

    input::placeholder {
      color: #94a3b8;
    }

    input:focus {
      border-color: #38bdf8;
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 
        0 0 0 4px rgba(56,189,248,.2),
        0 8px 25px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }

    /* SHAKE */
    .shake {
      animation: shake .4s;
      border-color: #ef4444 !important;
    }

    @keyframes shake {
      0%,100% { transform: translateX(0); }
      25% { transform: translateX(-6px); }
      50% { transform: translateX(6px); }
      75% { transform: translateX(-4px); }
    }

    .button-container {
      width: 100%;
      display: flex;
      flex-direction: column-reverse;
      gap: 10px;
    }

    button {
      width: 100%;
      padding: 15px 18px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: inherit;
      letter-spacing: 0.3px;
    }

    #nextBtn {
      background: linear-gradient(135deg,#38bdf8,#0ea5e9);
      color: #020617;
      box-shadow: 
        0 4px 15px rgba(14, 165, 233, 0.3),
        0 0 0 1px rgba(255, 255, 255, 0.1);
    }

    #nextBtn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 
        0 10px 25px rgba(14, 165, 233, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    #nextBtn:active:not(:disabled) {
      transform: translateY(0);
    }

    #backBtn {
      background: rgba(255,255,255,.08);
      color: #e5e7eb;
      border: 2px solid rgba(255,255,255,.15);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    #backBtn:hover:not(:disabled) {
      background: rgba(255, 255, 255, 0.12);
      border-color: rgba(255, 255, 255, 0.25);
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    #backBtn:active:not(:disabled) {
      transform: translateY(0);
    }

    button:disabled {
      opacity: .5;
      cursor: not-allowed;
      transform: none !important;
    }

    /* Completion message styling */
    .completion {
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
      justify-content: center;
    }

    .completion h2 {
      font-size: 2.5rem;
      background: linear-gradient(135deg, #38bdf8, #0ea5e9);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .completion p {
      font-size: 1.2rem;
      color: #cbd5e1;
      opacity: 0.9;
    }

    /* Tablet and above */
    @media (min-width: 768px) {
      .button-container {
        flex-direction: row;
      }

      #question {
        font-size: 1.35rem;
        padding: 32px 28px;
      }

      input {
        font-size: 17px;
        padding: 16px 20px;
      }

      button {
        padding: 16px 24px;
        font-size: 17px;
      }
    }

    /* Large screens */
    @media (min-width: 1200px) {
      .app {
        max-width: 600px;
      }

      #question {
        font-size: 1.45rem;
        padding: 36px 32px;
      }

      .progress {
        height: 10px;
      }
    }

    /* Small mobile adjustments */
    @media (max-width: 375px) {
      #question {
        font-size: 1.1rem;
        padding: 24px 20px;
      }

      input, button {
        font-size: 15px;
        padding: 13px 16px;
      }
    }

    /* Touch device optimizations */
    @media (hover: none) and (pointer: coarse) {
      button:active:not(:disabled) {
        transform: scale(0.97) !important;
      }
      
      input:focus {
        transform: none;
      }
    }

    /* Reduce motion for accessibility */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      
      body::before {
        animation: none;
      }
      
      .progress-bar {
        animation: none;
      }
    }
  </style>
</head>

<body>
  <div class="app" id="app">
    <div class="progress">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <h2 id="question"></h2>

    <input
      type="text"
      id="answer"
      placeholder="Type your answer here"
    />

    <div class="button-container">
      <button id="backBtn">Back</button>
      <button id="nextBtn">Next</button>
    </div>
  </div>

  <script>
    // Supabase config 
    const SUPABASE_URL = "https://fdghzacfmrxtsnpfisml.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZkZ2h6YWNmbXJ4dHNucGZpc21sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NjM3OTgsImV4cCI6MjA4NTIzOTc5OH0.RO3vDPJ4mf2tn1A4wfD8iarAUdNwEtLpt2GPk9viSaY";

    const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    const sessionId = crypto.randomUUID();

    const questions = [
      "What is your name?",
      "How old are you?",
      "What your relationship status at the moment?",
      "Does your dad gift you money?",
      "What the highest amount he has gifted you?",
      "NOTE ON A SCALE OF 0-20 HOW SATISFIED WILL YOU BE IF YOU RECIEVE AN AMOUNT FROM YOUR SPOUSE AND HOW MANY DAYS BEFORE THE EXCITMENT RUNS OUT.",
      "If you received 5000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 10000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 50000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 100000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 200000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 350000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 450000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 600000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 800000 naira, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1.2 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1.3 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1.4 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1.550 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1.7 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 1.850 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?",
      "If you received 2 million, what's the scale of your satisfaction?",
      "How many days before the excitement runs out?"
    ];

    let currentIndex = 0;

    const questionEl = document.getElementById("question");
    const answerEl = document.getElementById("answer");
    const nextBtn = document.getElementById("nextBtn");
    const backBtn = document.getElementById("backBtn");
    const progressBar = document.getElementById("progressBar");

    function updateProgress() {
      const progress = ((currentIndex + 1) / questions.length) * 100;
      progressBar.style.width = progress + "%";
    }

    function animateQuestionChange(newText) {
      questionEl.classList.add("slide-out");

      setTimeout(() => {
        questionEl.textContent = newText;
        questionEl.classList.remove("slide-out");
        questionEl.classList.add("slide-in");

        setTimeout(() => {
          questionEl.classList.remove("slide-in");
        }, 300);
      }, 300);
    }

    // Initial state
    questionEl.textContent = questions[currentIndex];
    updateProgress();
    backBtn.disabled = true;
    answerEl.focus();

    // Next button
    nextBtn.addEventListener("click", async () => {
      const answer = answerEl.value.trim();

      if (!answer) {
        answerEl.classList.add("shake");
        setTimeout(() => answerEl.classList.remove("shake"), 400);
        return;
      }

      nextBtn.disabled = true;

      // Save to Supabase
      const { error } = await client
        .from("responses")
        .insert([
          {
            session_id: sessionId,
            question: questions[currentIndex],
            answer: answer
          }
        ]);

      if (error) {
        console.error(error);
        alert("Failed to save answer. Please try again.");
        nextBtn.disabled = false;
        return;
      }

      answerEl.value = "";
      currentIndex++;

      if (currentIndex < questions.length) {
        animateQuestionChange(questions[currentIndex]);
        updateProgress();
        backBtn.disabled = false;
        nextBtn.disabled = false;
        answerEl.focus();
      } else {
        document.getElementById("app").innerHTML = `
          <div class="completion">
            <h2>All done! ðŸŽ‰</h2>
            <p>Thanks for completing the questionnaire.</p>
          </div>
        `;
      }
    });

    // Back button
    backBtn.addEventListener("click", () => {
      if (currentIndex === 0) return;

      currentIndex--;
      animateQuestionChange(questions[currentIndex]);
      updateProgress();

      answerEl.value = "";
      answerEl.focus();

      if (currentIndex === 0) {
        backBtn.disabled = true;
      }
    });

    // Enter key support
    answerEl.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        nextBtn.click();
      }
    });
  </script>
</body>
</html>